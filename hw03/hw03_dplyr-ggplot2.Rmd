---
title: "Dplyr and ggplot2 exploration"
author: "Amanda Cheung"
date: "10/1/2017"
output: github_document
---

## STAT545 Homework 03

Exploration and manipulation of the Gapminder dataset using dplyr and ggplot2.

## Gapminder, dplyr, and ggplot2
Load gapminder, and dplyr and ggplot2 via the tidyverse meta-package.
```{r}
library(gapminder)
library(tidyverse)
```

## Task 1: Get the maximum and minimum of GDP per capita for all continents

#### Table 1: Maximum and minimum GDP per capita for all continents.
```{r results= 'asis'}
knitr::kable(gapminder %>%
               group_by(continent) %>% 
               summarize(maximum_gdpPercap = max(gdpPercap),
                         minimum_gdpPercap = min(gdpPercap)))
```

#### Figure 1: Grouped bar plot of maximum and minimum GDP per capita for all continents.

Load reshape2 package.
```{r}
library(reshape2)
```
Melt data of interest using `melt` function.
```{r}
gdp_melt = melt(gapminder %>%
       group_by(continent) %>% 
       summarize(maximum_gdpPercap = max(gdpPercap),
                 minimum_gdpPercap = min(gdpPercap)))
```

Grouped bar plot of maximum and minimum GDP per capita for all continents
```{r}
ggplot(gdp_melt, aes(x=continent, y=value, fill=variable)) +
  geom_bar(position="dodge", stat="identity") + 
  theme_bw() +
  theme(legend.position="top", legend.title = element_blank(),
        plot.title = element_text(hjust = 0.5)) +
  scale_fill_discrete(labels=c("Maximum", "Minimum")) +
  labs(x="Continent", y="GDP per capita") +
  ggtitle("Maximum and minimum GDP per capita for all continents")
```

## Task 2: Look at the spread of GDP per capita within the continents.

#### Table 1: Maximum, minimum, median, average, and standard deviation of GDP per capita for all continents.
```{r results= 'asis'}
knitr::kable(gapminder %>%
               group_by(continent) %>% 
               summarize(maximum_gdpPercap = max(gdpPercap),
                         minimum_gdpPercap = min(gdpPercap),
                         median_gdpPercap = median(gdpPercap),
                         average_gdpPercap = mean(gdpPercap),
                         standard_deviation_gdpPercap = sd(gdpPercap)))
```

#### Figure 1: Distribution of GDP per capita within each continent using histograms.
```{r}
ggplot(gapminder, aes(x=gdpPercap)) +
  facet_wrap(~ continent) +
  geom_histogram(aes(fill=continent), bins=20) +
  scale_x_log10() +
  theme_bw() +
  labs(title="Distribution of GDP per capita") +
  theme(legend.position="bottom",
        plot.title=element_text(hjust=0.5),
        strip.background = element_rect(fill="lightcyan"),
        strip.text = element_text(size=12, face="bold"))
```

#### Figure 2: Box plot of GDP per capita distribution.
```{r}
ggplot(gapminder, aes(x=continent, y=gdpPercap)) +
  geom_boxplot(aes(colour=continent), outlier.shape=1) +
  theme_bw() +
  labs(title="Distribution of GDP per capita") +
  theme(plot.title=element_text(hjust=0.5))
```

#### Figure 3: Violin plot of GDP per capita distribution.
```{r}
ggplot(gapminder, aes(x=continent, y=gdpPercap)) +
  geom_violin(scale = "area", aes(fill=continent)) +
  theme_bw() +
  labs(title="Distribution of GDP per capita") +
  theme(plot.title=element_text(hjust=0.5))
```

#### Figure 4: Distribution of GDP per capita within each continent using frequency plots.
```{r}
ggplot(gapminder, aes(x=gdpPercap)) +
  facet_grid(~ continent) +
  geom_freqpoly(aes(colour=continent), bins=20) +
  scale_x_log10() +
  theme_bw() +
  labs(title="Distribution of GDP per capita") +
  theme(legend.position = "bottom",
        plot.title=element_text(hjust=0.5),
        strip.background = element_rect(fill="pink"),
        strip.text = element_text(size=12, face="bold"))
```






